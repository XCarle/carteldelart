<!DOCTYPE html>
<html lang="fr" ng-app="profile">
	<head>
		<title>Profile</title>
	    <link rel="shortcut icon" href="img/icone.png" type="image/x-icon" />
	    <!-- Bootstrap core CSS -->
	    <link href="/css/bootstrap.min.css" rel="stylesheet">
	    <!-- Bootstrap theme -->
	    <link href="/css/bootstrap-theme.css" rel="stylesheet">
		<link rel="stylesheet" href="css/profile/global.css"/>
		<link rel="stylesheet" href="css/profile/profile.css"/>		
		<link rel="stylesheet" href="css/font-awesome.css"/>		
		
		<link rel="stylesheet" href="css/build.css">
		<link href="css/admin-style.css" rel="stylesheet">
		
		<script type="text/javascript" src="/js/jquery-1.10.2.js"></script>
		<script type="text/javascript" src="/js/jquery-ui.js"></script>
		<script type="text/javascript" src="js/jquery.elevatezoom.js"></script>		
		<script type="text/javascript" src="js/angular.min.js"></script>
		<script type="text/javascript" src="js/angular-route.min.js"></script>
		<script type="text/javascript" src='/js/lodash.js'></script>
		<script type="text/javascript" src="js/angular-google-maps.js"></script>
		<script type="text/javascript" src="js/profile.js"></script>
		<script type="text/javascript" src="js/magapix-image.js"></script>
    
	</head>
	<header>
		<nav class="navbar navbar-inverse navbar-fixed-top" style="background-color:#FAF1E3;background-image:none;border:none;">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><img src="/img/icone.png" style="width:40px;height:40px;margin-top:-8px;"><label style="padding-left:10px;font-family:Helvetica;font-size:28px;color:#29374C;letter-spacing:2px;font-weight:100;"></label></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#" style="text-shadow:none;"><label style="padding-left:10px;">Profile</label><img src="/img/cartel_profil.png" style="height:27px;margin-top:-2px;float:left"></img></a></li>
            <li><a href="/creations" style="text-shadow:none;"><label style="padding-left:10px;">Oeuvres</label><img src="/img/cartel_catalogue.png" style="height:27px;margin-top:-2px;float:left"></img></a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
				<li class="dropdown">
					<a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><%= user.localemail %><span class="caret"></span></a>
					  <ul class="dropdown-menu">
						<li><a href="/logout">Déconnexion</a></li>
						<li><a href="#">Another action</a></li>
						<li><a href="#">Something else here</a></li>
						<li role="separator" class="divider"></li>
						<li class="dropdown-header">Nav header</li>
						<li><a href="#">Separated link</a></li>
						<li><a href="#">One more separated link</a></li>
					  </ul>
				</li>
          	   </ul>
        </div>
      </div>
    </nav>
	</header>
<body style="margin-left:10px;font-family:'Varela Round';background-color:white;margin-top:70px;">
    <section id="profileSection" class="container container-fluid" ng-controller="profileController as profileCtrl">
    <script>
	var idCreator = <%- JSON.stringify(user.id) %>; 
    </script>
        
        <div class="row">
            <form novalidate>
                <div class="col-md-6" ng-show="true">
                    <div ng-click="profileCtrl.clickAvatarDiv()" class="col-md-12" style="clear:both;margin-bottom:15px;font-size:20px;text-align:left;padding-left:15px;padding-top:10px;border-bottom:3px solid #FEDCA9;margin-right:13px;margin-top:10px;">
                        <ul class="list-inline" style="list-style-type:none;margin-bottom:0px;">
                            <li><label  style="float:left;font-size:20px;text-align:left;padding-left:15px;padding-top:10px;">Avatar</label><li>
                            <li ng-show="showValidAvatar" style="float:right;padding-top:5px;"><img src="/img/cartel-green.png" style="width:20px;height:20px;"></img></li>
                            <li ng-hide="showValidAvatar" style="float:right;padding-top:5px;"><img src="/img/cartel-red.png" style="width:20px;height:20px;"></img></li>
                        </ul>
                    </div>     
                    <div class="form-group col-md-12" ng-show="showAvatarParam">
                        <div style="margin-top:20px;text-align:center;">
                            <span id="btn-file" class="btn btn-file" style="border-radius:100%;box-shadow: 0px 0px 0px #29374C;width:150px;height:150px;padding-top:30px;" 
                                ng-click="profileCtrl.addCreationImage()">
                                <img src="/img/cartel 7_select-image-medium.png" id="buttonAddAvatarImage"
                                    style="width:90px; height:90px;"></img>
                                <input type="file" id="file_input" required></input>
                            </span>
                        </div> 
                    </div>
                    <div ng-click="profileCtrl.clickIdentiteDiv()" class="col-md-12" ng-show="showIdentiteDiv"
                        style="clear:both;margin-bottom:15px;font-size:20px;text-align:left;padding-left:15px;border-bottom:3px solid #FEDCA9;margin-right:13px;">
                        <ul class="list-inline" style="list-style-type:none;margin-bottom:0px;">
                            <li><label  style="float:left;font-size:20px;text-align:left;padding-left:15px;">Identité</label><li>
                            <li ng-show="showValidIdentite" style="float:right;padding-top:5px;"><img src="/img/cartel-green.png" style="width:20px;height:20px;"></img></li>
                            <li ng-hide="showValidIdentite" style="float:right;padding-top:5px;"><img src="/img/cartel-red.png" style="width:20px;height:20px;"></img></li>
                        </ul>
                    </div>
                    <div ng-show="showIdentiteParam">
                        <div class="form-group col-md-12" style="text-align:left;">
                            <ul class="list-inline">
                                <li><label for="prenom" style="padding-left:15px;width:100px;">Prénom</label></li>
                                <li><input type="text" class="form-control" id="prenom" placeHolder="{{prenom}}" ng-model="prenom" ng-model-options="{ getterSetter: true }"
                                required/></li>
                            </ul>
                        </div>
                        <div class="form-group col-md-12" style="text-align:left;">
                            <ul class="list-inline">
                                <li><label for="nom" style="padding-left:15px;width:100px;">Nom</label></li>
                                <li><input type="text" class="form-control" id="nom" placeHolder="{{nom}}" ng-model="nom" ng-model-options="{ getterSetter: true }"
                            required/></li>
                            </ul>
                        </div>
                    </div>
                    <div ng-click="profileCtrl.clickContactDiv()" class="col-md-12" ng-show="showContactDiv"
                        style="clear:both;margin-bottom:15px;font-size:20px;text-align:left;padding-left:15px;border-bottom:3px solid #FEDCA9;margin-right:13px;">
                        <ul class="list-inline" style="list-style-type:none;margin-bottom:0px;">
                            <li><label  style="float:left;font-size:20px;text-align:left;padding-left:15px;">Contact</label><li>
                            <li ng-show="showValidContact" style="float:right;padding-top:5px;"><img src="/img/cartel-green.png" style="width:20px;height:20px;"></img></li>
                            <li ng-hide="showValidContact" style="float:right;padding-top:5px;"><img src="/img/cartel-red.png" style="width:20px;height:20px;"></img></li>
                        </ul>
                    </div>
                    <div ng-show="showContactParam">
                        <div class="form-group col-md-12" style="text-align:left;">
                            <ul class="list-inline">
                                <li><label for="mail" style="padding-left:15px;width:100px;">Mail</label></li>
                                <li><input type="text" class="form-control" id="mail" placeHolder="{{mail}}" ng-model="mail" ng-model-options="{ getterSetter: true }"
                            required/></li>
                            </ul>
                        </div>
                        <div class="form-group col-md-12" style="text-align:left;">
                            <ul class="list-inline">
                                <li><label for="tel" style="padding-left:15px;width:100px;">N° Tel</label></li>
                                <li><input type="text" class="form-control" id="tel" placeHolder="{{tel}}" ng-model="tel" ng-model-options="{ getterSetter: true }"/>
                                </li>
                             </ul>
                        </div>
                        <div class="form-group col-md-12" style="text-align:left;">
                            <ul class="list-inline">
                                <li><label for="ntel" style="padding-left:15px;width:100px;">Site internet</label></li>
                                <li><input type="text" class="form-control" id="site" placeHolder="{{site}}" ng-model="site" ng-model-options="{ getterSetter: true }"/>
                                </li>
                             </ul>
                        </div>
                    </div>
                    <div ng-click="profileCtrl.clickBioDiv()" class="col-md-12" ng-show="showBioDiv"
                        style="clear:both;font-size:20px;text-align:left;padding-left:15px;border-bottom:3px solid #FEDCA9;margin-right:13px;">
                        <ul class="list-inline" style="list-style-type:none;margin-bottom:0px;">
                            <li><label  style="float:left;font-size:20px;text-align:left;padding-left:15px;">Biographie</label><li>
                            <li ng-show="showValidBio" style="float:right;padding-top:5px;"><img src="/img/cartel-green.png" style="width:20px;height:20px;"></img></li>
                            <li ng-hide="showValidBio" style="float:right;padding-top:5px;"><img src="/img/cartel-red.png" style="width:20px;height:20px;"></img></li>
                        </ul>
                    </div>
                    <div ng-show="showBioParam">
                        <div class="form-group col-md-12" style="text-align:left;margin-top:10px;padding-top:10px;">
                            <textarea id="bio" class="form-control" rows="3" placeholder="Vos inspirations culturelles"  ng-model="bio" max="400" style="font-family:Helvetica;font-size:12px;"   ng-model-options="{ getterSetter: true }"
                            required> 
                            </textarea>
                            <label for="bio" style="padding-left:15px;text-align:right;margin-top:10px;">({{bio.length}} / {{bioLength}})</label>
                        </div>
                    </div>
                    <div ng-click="profileCtrl.clickDroitAuteurDiv()" class="col-md-12" ng-show="showDroitsDiv"
                        style="clear:both;font-size:20px;text-align:left;padding-left:15px;border-bottom:3px solid #FEDCA9;margin:10px auto;margin-right:13px;">
                         <ul class="list-inline" style="list-style-type:none;margin-bottom:0px;">
                         <li><label  style="float:left;font-size:20px;text-align:left;padding-left:15px;">Conditions particulières d'utilisation</label><li>
                            <li ng-show="showValidDroits" style="float:right;padding-top:5px;"><img src="/img/cartel-green.png" style="width:20px;height:20px;"></img></li>
                            <li ng-hide="showValidDroits" style="float:right;padding-top:5px;"><img src="/img/cartel-red.png" style="width:20px;height:20px;"></img></li>
                        </ul>
                    </div>
                    <div class="col-md-12" ng-show="showDroitsParam">
                        <p style="overflow:scroll; border:#29374C 1px solid; height:200px;">
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                            Du texte Du texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texteDu texte
                        </p>
                        <ul class="dl-horizontal" style="margin-left:-40px;">
                            <dt style="width:20px;margin-left:-10px;"><input type="checkbox" ng-model="droitAccepted"></input></dt>
                            <dd style="margin-left:20px;">Vous acceptez les <a href="">Conditions Particulières d'Utilisation</a>.
                                    En publiant des oeuvres sur Cartel, j'accepte de céder mes droits de représentation.
                            </dd>
                        </ul>  
                    </div>
                    <div ng-show="showValidateButton" class="col-md-8" style="text-align:center;margin-top:30px;" >
                        <button class="btn" ng-click="pushSetUp()" style="background-color:#FEDCA9;color:#29374C;">Valider</button>
                    </div>
                </div>
        
        
                <div class="col-md-4" style="margin-top:20px;">
                    <div class ="row">
                        <div id="pageProfile" style="width:308px;border:1px solid #FEDCA9;height:548px;margin:0 auto;" ng-click="profileCtrl.clickProfile()">
                            <div style="position:relative;height:34px; width:308px;text-align:center;margin-top:5px;">
                                <label >Profil</label>
                            </div>
                            <div load-avatar url="url" style="margin-left:79px;margin-top:15px;">
                                <img id="profileImage" style="border-radius:100%;border:1px solid #29374C; width:150px;height:150px;"></img>
                            </div>
                            <div style="text-align:center;margin-left:-35px;">
                                <ul style="list-style-type:none;">
                                    <li><label style="font-size:18px;"><br>{{prenom+" "}}{{nom}}</br></label></li>
                                    <li><label style="font-size:17px;color:#FEDCA9;">1 <img src="/img/cartel-etoile-jaune.png" style="width:20px;height:20px;margin-top:-5px;"></img></label></li>
                                    <li><label style="font-size:11px;color:#29374C;font-weight:lighter;">Artiste</label></li>
                                </ul>
                            </div>
                            <div style="margin:5px auto;width:20px;border:1px solid #FEDCA9;">
                            </div>
                            <div style="font-size:12px;margin-left:15px; margin-right:15px;margin-top:10px;">
                                <label style="word-break: normal;">
                                    {{bio}}
                                </label>
                            </div>
                            <div show-validation-button style="margin-bottom:20px;">
                                <button id="validationButton" class="btn" ng-click="profileCtrl.addProfileDetails()" style="border-radius:0px;margin-left:-2px;width:309px;position:absolute;bottom:-10px;padding-top:10px;">
                                    <label>{{validationButtonLabel}}</label>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        
            <div id="creationSection" ng-controller="CreationController as creationCtrl" > 
                <div class="col-md-8">
                    <div class="row" ng-show="showThumbnailList">
                        <div class="col-md-6" ng-repeat="creation in creationCtrl.creator[0].creator.creations track by $index">
                            <div id="listThumb_{{creation.id_creation}}" click-thumbnail set-up-preview ng-click="creationCtrl.clickThumb(creation);" 
                            style="background-image:{{creation.thumbnailUrl}};
                            position:relative;margin:20px auto;min-height:250px;width:250px;
                            background-size:250px 250px;
                            background-repeat:no-repeat;box-shadow: 0px 0px 0px #29374C;z-index:1;" id="thumbnail">
                                <div style="position:absolute;height:40px;padding-top:10px;padding-left:10px;padding-right:10px;bottom:0px;width:250px;background-color:rgba(255,255,255,0.93);">
                                    <label style="word-wrap:break-word;width:240px;font-family:Helvetica;font-weight:100;">{{creation.properties[0].title}}</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4"  ng-show="showCreationAddButton"  style="min-height:250px;width:250px;margin:0 auto;margin-left:30px;">
                            <span add-creation id="btnNewCreation" class="btn" ng-click="creationCtrl.addCreation()" style="margin-top:30px;width:220px;height:220px;">
                                <img style="width:125px; height:125px;margin-top:45px;" src="/img/cartel_7_plus.png"></img>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div id="creationParam" style="width:80%;margin-left:10%;padding-top:10px;border-bottom:4px solid #FEDCA9;" ng-show="showCreationConfig">
                        <h1 style="text-align:center;font-size:30px;">Paramétrage d'une oeuvre</h1>
                    </div>
                        <div ng-show="showCreationConfig" style="margin-top:40px;min-height:1000px;">				
                            <div class="row">
                                <div class="col-lg-4" style="box-shadow: 0px 0px 0px #29374C;">
                                    <div ng-show="showPreview">
                                        <div style="border-bottom:3px solid #FEDCA9;margin-bottom:10px;">
                                            <p id="status" style="font-size:20px;padding-left:15px;text-align:left;margin-right:15px;max-width:348px;">Aper&ccedil;u</p>
                                        </div>
                                        <div ng-hide="showAddImageButton" style="text-align:center;">
                                            <img id="preview" class="preview" style="width:250px;height:250px;" />
                                        </div>
                                    </div>		
                        
                                    <form id="formImage" name="creationForm" novalidate>
                                        <div class="form-group">
                                            <div click-div-photo ng-click="creationCtrl.clickOnDivConfigPhoto()" style="border-bottom:3px solid #FEDCA9;margin-right:13px;">
                                                <p id="status" style="font-size:20px;text-align:left;padding-left:15px;padding-top:10px;">Photo</p>
                                            </div>
                                            <div ng-show="showAddImageButton" style="margin-top:20px;">
                                                <span id="btn-file" class="btn btn-file" style="box-shadow: 0px 0px 0px #29374C;margin-left:15px;width:250px;height:250px;padding-top:75px;" ng-click="creationCtrl.addCreationImage()">
                                                    <img src="/img/cartel 7_select-image-medium.png" style="width:90px; height:90px;"></img>
                                                    <input type="file" id="file_input" required></input>
                                                </span>
                                            </div>
                                            <div ng-hide="showAddImageButton">
                                                <p style="padding-top:20px;" ng-show="showChangeImageButton">Positionner l'image</p>
                                            </div>
                                            <div class="btn-group" style="margin-top:20px;width:400px;" ng-show="showChangeImageButton">
                                                <button left-button id="left" class="btn" style="margin-left:0px;width:40px; background-color:white;border:1px solid #FEDCA9;">
                                                    <span class="fa fa-arrow-left">
                                                    </span>
                                                </button>
                                                <button right-button id="right" class="btn" style="margin-left:7px;background-color:white;border:1px solid #FEDCA9;">
                                                    <span class="fa fa-arrow-right">
                                                    </span>
                                                </button>
                                                <button up-button id="up" class="btn" style="margin-left:7px;background-color:white;border:1px solid #FEDCA9;">
                                                    <span class="fa fa-arrow-up">
                                                    </span>
                                                </button>
                                                <button down-button id="down" class="btn" style="margin-left:7px;background-color:white;border:1px solid #FEDCA9;">
                                                    <span class="fa fa-arrow-down">
                                                    </span>
                                                </button>
                                                <button zoom-in-button id="zoomIn" class="btn" style="margin-left:7px;background-color:white;border:1px solid #FEDCA9;">
                                                    <span class="fa fa-search-plus">
                                                    </span>
                                                </button>
                                                <button zoom-out-button id="zoomOut" class="btn" style="margin-left:7px;background-color:white;border:1px solid #FEDCA9;">
                                                    <span class="fa fa-search-minus">
                                                    </span>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="row" ng-show="showChangeImageButton">
                                            <div class="form-group col-lg-12" style="text-align:center">
                                                <button class="btn" ng-click="creationCtrl.addImageToCreation()">Valider</button>
                                            </div>
                                        </div>
                                    </form>
                        
                                    <div style="margin-top:-10px;">
                                        <div ng-click="creationCtrl.clickOnDivConfigDescription()" style="border-bottom:3px solid #FEDCA9;margin-right:13px;">
                                            <p id="status" style="font-size:20px;text-align:left;padding-left:15px;padding-top:10px;">Description</p>
                                        </div>
                                        <form name="creationDetails" ng-show="showDescriptionModule">
                                            <div class="form-group" style="text-align:left;margin-top:20px;">
                                                <label for="creationTitle" style="padding-left:15px;">Titre</label>
                                                <input type="text" class="form-control" id="creationTitle" placeHolder="{{title}}" ng-model="title" ng-model-options="{ getterSetter: true }"
                                                    style="max-width:285px;" required/>
                                            </div>
                                            <div class="form-group" style="text-align:left;margin-top:10px;">
                                                <label for="cartel" style="padding-left:15px;">Commentaires ({{cartel.length - nbCharCartel}})</label>
                                                <textarea id="cartel" class="form-control" rows="16" placeholder="{{cartel}}"  ng-model="cartel" max="800" style="font-family:Helvetica;font-size:12px;max-width:285px;"   ng-model-options="{ getterSetter: true }"
                                                required> 
                                                </textarea>
                                            </div>
                                            <div class="form-group" style="text-align:left;padding-top:10px;">
                                                <label for="creationDate" style="padding-left:15px;">Date de création</label>
                                                <input id="creationDate" class="form-control" type="month" ng-model="dateCreation" min="1950-01" max="2015-10" style="max-width:285px;" required/>
                                            </div>
                                            <div class="form-group" style="text-align:left;">
                                                <label for="medium" style="padding-left:15px;">medium</label>
                                                <select id="medium" class="form-control" ng-model="medium" style="width:290px;" required>
                                                    <option value="Céramique">Céramique</option>
                                                    <option value="Bijouterie">Bijouterie</option>
                                                    <option value="Collage">Collage</option>
                                                    <option value="Dessin">Dessin</option>
                                                    <option value="Estampe">Estampe</option>
                                                    <option value="Graphisme">Graphisme</option>
                                                    <option value="Illustration">Illustration</option>
                                                    <option value="installation">Installation</option>
                                                    <option value="Lithographie">Lithographie</option>
                                                    <option value="Peinture">Peinture</option>
                                                    <option value="Performance">Performance</option>
                                                    <option value="Photographie">Photographie</option>
                                                    <option value="Sculpture">Sculpture</option>
                                                    <option value="Tapisserie">Tapisserie</option>
                                                    <option value="Techniques mixtes">Techniques mixtes</option>
                                                    <option value="Textile">Textile</option>
                                                    <option value="Video">Video</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label>Dimensions (cm)</label>
                                            </div>
                                            <div class="row">
                                                <div class="form-group col-lg-4" style="margin-left:-5px;">
                                                    <input id="hauteur" style="width:85px;font-size:10px;" class="form-control" type="number" placeholder="{{s_h}}" ng-model="s_h" required/>
                                                    </div>
                                                <div class="form-group col-lg-4">
                                                <input id="longueur" class="form-control" style="margin-left:-10px;width:97px;font-size:10px;" type="number" placeholder="{{s_w}}" ng-model="s_w" required/>
                                                </div>
                                                <div class="form-group col-lg-4">
                                                    <input id="largeur" class="form-control" style="margin-left:-10px;width:88px;font-size:10px;" type="number" placeholder="{{s_l}}" ng-model="s_l" required/>
                                                </div>
                                            </div>
                                            <div class="form-group col-lg-12" style="text-align:center">
                                                <button class="btn" ng-click="creationCtrl.addCreationDetailToImage()">Valider</button>
                                            </div>
                                        </form>
                                    </div>
                        
                                    <div ng-click="creationCtrl.clickOnDivConfigGeolocalisation()" style="border-bottom:3px solid #FEDCA9;margin-right:13px;">
                                        <p id="status" style="font-size:20px;text-align:left;padding-left:15px;padding-top:10px;">Géolocalisation</p>
                                    </div>
                                    <div ng-show="showGeolocationModule">
                                        <div style="margin-top:15px;">
                                            <label for="adresse">Adresse : </label>
                                            <input type="text" class="form-control" id="adresse" placeHolder="{{adresse}}" ng-model="adresse" ng-model-options="{ getterSetter: true }"
                                                style="max-width:285px;" required/>
                                        </div>
                                        <div style="margin-top:15px;text-align:left;">
                                            <button class="btn" ng-click="creationCtrl.clickGeolocation()">Enregistrer</button>
                                        </div>
                                        <div ng-show="showGetPosition">
                                            <div class="row" style="margin-top:10px;">
                                                <div class="col-md-4" >
                                                    <div  style="margin-top:10px;margin-right:-30px;border-bottom:3px solid #FEDCA9;width:20px;float:right">
                                                    </div>
                                                </div>
                                                <div class="col-md-4" style="text-align:center;">
                                                    <label>OU</label>
                                                </div>
                                                <div class="col-md-4">
                                                    <div style="margin-top:10px;margin-left:-30px;border-bottom:3px solid #FEDCA9;width:20px;float:left">
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="clickGeoloc" style="margin-top:10px;text-align:center;margin-bottom:20px;">
                                                <button click-geolocation id="buttonClickGeoloc" class="btn">Position actuelle</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="row" ng-show="showGeolocationSavingButton" style="margin-top:20px;">
                                            <label style="margin-bottom:15px;">{{adresse}}</label>
                                            <div class="col-md-6">
                                                <button class="btn" ng-click="creationCtrl.validateGeolocation()" ng-hide="hideGeolocationSavingButton">Valider</button>
                                            </div>
                                            <div class="col-md-6">
                                                <button class="btn" ng-click="creationCtrl.changeGeolocation()" ng-hide="hideGeolocationSavingButton">Modifier</button>
                                            </div>
                                        </div>
                                    </div>
                        
                                    <div ng-click="creationCtrl.clickOnDivConfigGestion()" style="border-bottom:3px solid #FEDCA9;margin-right:13px;">
                                        <p id="status" style="font-size:20px;text-align:left;padding-left:15px;padding-top:10px;">Gestion des droits d'auteur</p>
                                    </div>
                                    <div ng-show="showAdminModule" style="margin-top:10px;">
                                        <ul class="dl-horizontal" style="margin-left:-40px;">
                                            <dt style="width:20px;margin-left:-10px;"><input type="checkbox" checked="true"></input></dt>
                                            <dd style="margin-left:20px;">En publiant cette oeuvre sur Cartel, vous acceptez de céder ses droits de représentation. Pour plus d'information consulter les <a href="">Conditions Particulières d'Utilisation</a>
                                            </dd>
                                        </ul>
                                        <button class="btn" ng-click="creationCtrl.deleteCreation()">Supprimer l'image</button>
                                    </div>
                                                                
                                </div>
                    
                    
                
                
                                <div class="col-xs-4" ng-show="showPreview">
                                    <div style="border-bottom:3px solid #FEDCA9;margin-left:-15px;margin-bottom:10px;max-width:318px;margin-left:20px;">
                                        <p id="status" style="font-size:20px;padding-left:15px;text-align:left;padding-right:50px;">Aper&ccedil;u catalogue</p>
                                    </div>
                                    <div class ="row">
                                        <div style="width:308px;margin-left:40px;">
                                            <div id="catalogImageDiv" style="margin-bottom:15px;min-height:548px;width:308px;margin-right:5px;
                                                background-size:308px 548px;background-repeat:no-repeat;
                                                box-shadow: 0px 0px 0px #29374C;margin-right:50px;z-index:-10;">
                                            </div>
                                            <div style="margin-left:15px;z-index:1;">
                                                <div style="position:absolute;margin-top:-117px;padding-left:15px;height:102px;padding-top:20px;padding-right:5px;margin-left:-15px;width:308px;background-color:rgba(255,255,255,0.93);">
                                                    <div class="row">
                                                        <div class="col-xs-8">
                                                            <a style="margin-top:10px;font-family:Helvetica;font-weight:100;font-size:20px;color:#29374C;">Nom de l'auteur</a>
                                                            <a style="word-wrap:break-word;width:240px;font-family:Helvetica;font-weight:10px;color:#29374C;" ><br>{{title}}</br></a>
                                                            <a style="word-wrap:break-word;line-height:1;width:240px;font-family:Helvetica;font-weight:10px;color:#29374C;">{{dateCreation | date:"MMMM yyyy"}}</a>
                                                        </div>
                                                        <div class="col-xs-4">
                                                            <div class="row" style="text-align:right;padding-right:19px;margin-top:4px;">
                                                                1  	  <span><img src="/img/cartel_etoile.png" style="width:16px;height:15px;margin-top:-4px;"></img></span>
                                                            </div>
                                                            <div class="row" style="text-align:right;padding-right:18px;margin-top:4px;">
                                                                0	   <span><img src="/img/cartel_oeil.png" style="width:17px;height:11px;margin-top:-4px;"></img></span>
                                                            </div>
                                                            <div class="row" style="text-align:right;padding-right:22px;margin-top:4px;;">
                                                                0 km 	 <span><img src="/img/cartel_lieu.png" style="width:9px;height:15px;margin-top:-4px;"></img></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div style="margin-top:-40px;margin-left:110px;position:absolute;top:0px;">
                                                        <canvas id="circleCanvas" width="100" height="100" style="position:static;" />
                                                    </div>
                                                </div>																
                                            </div>
                                        </div>
                                    </div>
                                </div>
                
                
                                <div class="col-xs-4" style="font-family:Helvetica;margin-left:2%;width:31%;" ng-show="showPreview">
                                    <div>
                                        <div style="border-bottom:3px solid #FEDCA9;margin-left:-20px;margin-bottom:10px;width:318px;">
                                            <p id="status" style="font-size:20px;padding-left:15px;text-align:left;font-family:'Varela Round';padding-right:50px;">Aper&ccedil;u détail</p>
                                        </div>
                                        <div style="position:absolute;top:50px;text-align:center;margin-left:-16px;z-index:1;background-color:white;width:308px;height:34px;">
                                            <div class="row">
                                                <div class="col-xs-8" style="z-index:-10;">
                                                    <p  style="font-family:'Varela Round';font-size:20px;padding-top:5px;text-align:right;padding-right:14px;">
                                                    Cartel</p>
                                                </div>
                                                <div class="col-xs-4">
                                                    <img src="/img/icone.png" style="width:22px;height:22px;margin-left:52px;margin-top:6px;"></img>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="detailImageDiv" style="position:absolute;top:84px;margin-left:-16px;width:308px;height:1px;" data-zoom-image="{{url}}">
                                        </div>
                                        <div class="row" id="divIndicator" style="position:absolute;top:342px;height:44px;padding-top:4px;margin-left:-16px;background-color:white;width:308px;padding-top:8px;">
                                            <div class="col-xs-4" style="font-size:11px;">
                                                217  <img src="/img/cartel_etoile.png" style="width:16px;height:15px;margin-top:-4px"></img>
                                            </div>
                                            <div class="col-xs-4" style="text-align:center;font-size:11px;">
                                                8 000  <img src="/img/cartel_oeil.png" style="width:17px;height:11px;margin-top:-4px"></img>
                                            </div>
                                            <div class="col-xs-4" style="text-align:right;font-size:11px;">
                                                0.3 km  <img src="/img/cartel_lieu.png" style="width:10px;height:15px;margin-top:-4px"></img>
                                            </div>
                                            <div class="col-xs-4">
                                                <img></img>
                                            </div>
                                            <div class="col-xs-4">
                                                <img></img>
                                            </div>
                                        </div>
                                        <div id="divDescription"style="position:absolute;top:372px;width:308px;margin-left:-16px;padding-left:15px;padding-right:15px;padding-bottom:210px;background-color:white;padding-top:10px;
                                                        border-top-color:#FEDCA9; border-top-style:solid; border-top-width:2.5px;">
                                            <div style="min-height:100px;">
                                                <p style="font-size:27px;font-color:#29374C;">Cindy Sherman</p>
                                                <p style="font-size:20px;font-color:#939597;">{{title}}</p>
                                                <p style="font-size:14px;font-color:#29374C; word-wrap:break-word;">{{cartel}}</p>
                                            </div>
                                            <div style="border-top-color:#FEDCA9; border-top-style:solid; border-top-width:2.5px;width:30px;">
                                            </div>
                                            <div style="margin-top:5px;">
                                                <p>Biographie de 400 caractères</p>
                                            </div>
                                            <div style="border-top-color:#FEDCA9; border-top-style:solid; border-top-width:2.5px;width:30px;">
                                            </div>
                                            <div style="position:absolute;bottom:110px;width:308px;margin-left:-14px;padding-left:15px;padding-top:10px;background-color:white;">
                                                <p>{{dateCreation | date:"MMMM yyyy"}}</p>
                                                <p>Médium : {{medium}}</p>
                                                <p>{{s_h}} cm x {{s_w}} cm x {{s_l}} cm</p>
                                            </div>
                        
                        
                                            <div class="row" style="position:absolute;bottom:0px;width:309px;height:100px;margin-left:-15px;background-color:#FEDCA9;">
                                                <div class="col-xs-6" style="background-color:#FEDCA9;height:70px;width:149px;margin-top:15px;
                                                                        border-right-color:white;border-right-style:solid; border-right-width:2.5px;">
                                                    <span style="padding-left:35px;">
                                                        <img src="/img/button-chat.png" style="width:50px;height:50px;margin-top:12px;"><img/>
                                                    </span>
                                                </div>
                                                <div class="col-xs-6" style="background-color:#FEDCA9;height:100px;margin-left:5px;">
                                                    <span style="padding-left:30px;padding-top:25px;">
                                                        <img src="/img/button-exposition.png" style="width:60px;height:50px;margin-top:25px;"><img/>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                <div>
                            </div>  
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script>
	var elem = document.getElementById('circleCanvas');
	var context = elem.getContext('2d');
	
	// Add shadow to canvas
	context.shadowOffsetX = 1;
	context.shadowOffsetY = 1;
	context.shadowBlur = 2;
	context.shadowColor = 'rgba(30,30,30, 0.5)';
	
	// Draw circle (yellow)
	context.beginPath();
	context.arc(30, 30, 30, 0, 2 * Math.PI, false);
	context.fillStyle = "#FEDCA9";
	context.fill();
</script>
<script type="text/javascript">
/*
    Function to carry out the actual PUT request to S3 using the signed request from the app.
*/
    
    function upload_file(file, signed_request, url){
        var xhr = new XMLHttpRequest();
        
       
        console.log("upload file");
        
        xhr.open("PUT", signed_request);
        xhr.setRequestHeader('x-amz-acl', 'public-read');
        xhr.onload = function() {
            
            if (xhr.status === 200) {
                console.log("url : ", url);
                
                // on dessine l'image dans un canvas de 150 * 150 px
                var profile_canvas = document.createElement('canvas');
                profile_canvas.width = 150;
                profile_canvas.height = 150;
                
                var pImage = new Image();
                pImage.crossOrigin = "Anonymous";
                pImage.onload = function(){
                    // on cacule les metriques de dessin
                    var x, y, d_x;
                    if (pImage.width > pImage.height){
                        d_x = pImage.height;
                        x = (pImage.width - pImage.height) / 2;
                        y = 0;
                    }else{
                        d_x = pImage.width;
                        y = (pImage.height - pImage.width) / 2;
                        x = 0;                        
                    }
                    
                    // memorize the elements
                    var $element = document.getElementById("profileSection");
                    var $scope = angular.element($element).scope();
                
                    $scope.$apply(function(){
                        $scope.a_x = x;
                        $scope.a_y = y;
                        $scope.a_d_x = d_x;
                        $scope.changeShowParam(3);
                    });
                    profile_canvas.getContext('2d').drawImage(pImage, x, y, d_x, d_x, 0, 0, 150, 150);
                    var dataUrl = profile_canvas.toDataURL();
                    document.getElementById("profileImage").src = dataUrl;  
                    
                    document.getElementById("buttonAddAvatarImage").src = dataUrl;
                    document.getElementById("buttonAddAvatarImage").style.width = "150px";
                    document.getElementById("buttonAddAvatarImage").style.height = "150px";
                    document.getElementById("buttonAddAvatarImage").style.borderRadius = "100%";
                    document.getElementById("buttonAddAvatarImage").style.marginLeft="-13px";
                    document.getElementById("buttonAddAvatarImage").style.marginTop="-30px";
                }
                
                pImage.src = url;
            }
        };
        xhr.onerror = function() {
            alert("Could not upload file."); 
        };
        xhr.send(file);
    }

    /*
        Function to get the temporary signed request from the app.
        If request successful, continue to upload the file using this signed
        request.
    */
    function get_signed_request(file){
        var xhr = new XMLHttpRequest();
        console.log("get signed request");
        // TO DO - Calculate file name
        // file name = c_creatorName_idImage 
        var file_name =  set_sign_request();

        xhr.open("GET", "/sign_s3_avatar?file_name="+file_name+"&file_type="+file.type);
        xhr.onreadystatechange = function(){
            if(xhr.readyState === 4){
                if(xhr.status === 200){
                    var response = JSON.parse(xhr.responseText);
                    upload_file(file, response.signed_request, response.url);
                }
                else{
                    alert("Could not get signed URL.");
                }
            }
        };
        xhr.send();
    }

    function set_sign_request(){
        var tmpUrl;
        
        var $element = document.getElementById("profileSection");
        var $scope = angular.element($element).scope();
                
        $scope.$apply(function(){
            tmpUrl = $scope.url;
        });
        return tmpUrl;
    }

    /*
       Function called when file input updated. If there is a file selected, then
       start upload procedure by asking for a signed request from the app.
    */
    function init_upload(){
        // mise en forme de l'image
        format_image();
    
        //var files = document.getElementById("file_input").files;
        //var file = files[0];
    }

    var image = new Image();

    function format_image(){
        // on récupère le fichier
        var files = document.getElementById("file_input").files;
        var file = files[0];
    
        var reader = new FileReader();
    
        // on créé le canvas de réception
        var resize_canvas = document.createElement('canvas');

        
        // on lit le fichier source
        if (file){		
            reader.readAsDataURL(file);
        }
    
        reader.onloadend = function(_file){
            // on écrit dans l'image tampon.
            image.src = reader.result;
        
            // calculate new image size
            var size = image.width + image.height;
            var newW = image.width * 800 / size;
            var newH = image.height * 800 / size;
        
            // on initialise les canvas 
            resize_canvas.width = newW;
            resize_canvas.height = newH;
            
            var mpImg = new MegaPixImage(image);
			mpImg.render(resize_canvas, { maxWidth: newW, maxHeight: newH, });
			
            // FULL IMAGE CANVAS RESIZED
            //resize_canvas.getContext('2d').drawImage(image, 0, 0, newW, newH);
            fullImageUrl = resize_canvas.toDataURL();
            
            var newFullHeight = image.height*308/image.width;
     
            // CODE FOR SENDING
            var file = dataURItoBlob(resize_canvas.toDataURL());
            if(file == null){
                alert("No file selected.");
                return;
            }
            
            get_signed_request(file);
        
            // manage error
            image.onerror = function(){
                alert('Invalid File Type : ', file.type);
            };
        }
    }

    function dataURItoBlob(dataURI) {
        // convert base64 to raw binary data held in a string
        var byteString = atob(dataURI.split(',')[1]);
 
        // separate out the mime component
        var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
 
        // write the bytes of the string to an ArrayBuffer
        var arrayBuffer = new ArrayBuffer(byteString.length);
        var _ia = new Uint8Array(arrayBuffer);
        for (var i = 0; i < byteString.length; i++) {
            _ia[i] = byteString.charCodeAt(i);
        }
 
        var dataView = new DataView(arrayBuffer);
        var blob = new Blob([dataView], { type: 'image/png' });
        return blob;
    }

    /*
       Bind listeners when the page loads.
    */
    (function() {
        document.getElementById("file_input").onchange = init_upload;
    })();
</script> 

    <footer class="footer" id="footer">
        <cartel-footer>
        </cartel-footer>
    </footer>	
    	<div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/fr_FR/sdk.js#xfbml=1&version=v2.4&appId=1485534465076102";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

</body>
</html>